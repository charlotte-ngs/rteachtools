---
title: "Getting Started with a new Course"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Getting Started with a new Course}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  eval = FALSE
)
```

# Disclaimer
Before every semester when preparing the infrastructure for a new course or for a new version of an existing course, the same tasks have to be carried out. The outline given below gives a few hints and ideas on how this process could be automated. In what follows, we start with a description of the manual process that is used so far. The second part contains possible ideas for automation.


# Assumptions
The course is assumed to be a course consisting of the following components

* course notes
* exercises 
* solutions to exercises
* additional material

The structure of the course should be kept as flexible as possible. Hence, further components such as student projects or homework or term projects should be easily integrable.


# Manual Setup Process for asmss2022
The following steps are taken in the setup process

* Step 1: Start a new RStudio project

```bash
R -e 'usethis::create_project(path = "/Users/pvr/Data/Projects/Github/charlotte-ngs/asmss2022_gh-root/main/asmss2022", rstudio = TRUE)'
```


* Step 2: Add a description file

```{r, eval=FALSE}
usethis::use_description(fields = getOption("charlotte.ngs.description"))
```

This file must be edited and adapted according to the new course. This can be done via

```{r, eval=FALSE}
usethis::edit_file(path = "DESCRIPTION")
```


* Step 3: Licence is added 

```{r, eval=FALSE}
usethis::use_cc0_license()
```


* Step 4: README File is added

```{r, eval=FALSE}
usethis::use_readme_rmd()
```

The README file is the main page of content, not only for the Github page, but also for the website which will be created via `pkgdown`


* Step 5: Git Repository

```{r, eval=FALSE}
usethis::use_git()
```


* Step 6: Setting up the pages for the website

```{r, eval=FALSE}
usethis::use_vignette(name = "course_notes", title = "Course Notes")
usethis::use_vignette(name = "course_exercises", title = "Exercises")
usethis::use_vignette(name = "course_solutions", title = "Solutions")
usethis::use_vignette(name = "course_additional_material", title = "Additional Material")
```


* Step 7: Adding a news site

```{r, eval=FALSE}
usethis::use_news_md()
```


* Step 8: Install package

```{r, eval=FALSE}
devtools::document();devtools::install()
```

* Step 9: Build Site

```{r, eval=FALSE}
pkgdown::build_site()
```

After committing and pushing all the material, the material should be available.


# Second Example: pigsciencess2022

```bash
cd && cd Data/Projects/GitHub/charlotte-ngs
~/Data/Projects/GitHub/fbzwsqualitasag/qmactools/inst/bash/nrsproj.sh \
-t ~/Data/Projects/GitHub/fbzwsqualitasag/qmactools/inst/template/rstudio/RStudioTemplate.Rproj \
-p pigsciencess2022_gh-root/main/pigsciencess2022
```

* Step 2: Add a description file

```{r, eval=FALSE}
usethis::use_description()
```

This file must be edited and adapted according to the new course. This can be done via

```{r, eval=FALSE}
usethis::edit_file(path = "DESCRIPTION")
```


* Step 3: Licence is added 

```{r, eval=FALSE}
usethis::use_cc0_license()
```


* Step 4: README File is added

```{r, eval=FALSE}
usethis::use_readme_rmd()
```

The README file is the main page of content, not only for the Github page, but also for the website which will be created via `pkgdown`


* Step 5: Git Repository

```{r, eval=FALSE}
usethis::use_git()
```


* Step 6: Setting up the pages for the website

```{r, eval=FALSE}
usethis::use_vignette(name = "course_notes", title = "Course Notes")
usethis::use_vignette(name = "course_exercises", title = "Exercises")
usethis::use_vignette(name = "course_solutions", title = "Solutions")
usethis::use_vignette(name = "course_additional_material", title = "Additional Material")
```


* Step 7: Adding a news site

```{r, eval=FALSE}
usethis::use_news_md()
```


* Step 8: Install package

```{r, eval=FALSE}
devtools::document();devtools::install()
```

* Step 9: Build Site

```{r, eval=FALSE}
pkgdown::build_site()
```

* Step 10: Create Repo on Github

Create the new repo on the Github platform and run locally

```bash
git remote add origin https://github.com/charlotte-ngs/pigsciencess2022.git
git branch -M main
git config user.name "charlotte-ngs"
git config credential.username "charlotte-ngs"
git push -u origin main
```

After committing and pushing all the material, the material should be available.


## Template for Course Notes

```{r, eval=FALSE}
usethis::use_rmarkdown_template(template_name = "Course Notes Bookdown Skeleton Project", 
                                template_dir = 'cnotesdown',
                                template_description = 'Course Notes Bookdown Skeleton Project for Charlotte-NGS',
                                template_create_dir = TRUE)
```

Install package to make template available

```{r, eval=FALSE}
devtools::document();devtools::install()

```


## Starting Course  Notes

```{r, eval=FALSE}
rmarkdown::draft("cn", template = "cnotesdown", package = "rteachtools")
fs::file_move("cn/cn.Rmd", "cn/index.Rmd")
```

Change template settings


## Slides
Create template

```{r, eval=FALSE}
usethis::use_rmarkdown_template(template_name = "Course Beamer Slide Skeleton Document", 
                                template_dir = 'cbeamerdown',
                                template_description = 'Course Beamer Slide Skeleton Document for Charlotte-NGS',
                                template_create_dir = TRUE)
```

Start a new slides document

```{r, eval=FALSE}
rmarkdown::draft("sl/l01_psb_intro", template = "cbeamerdown", package = "rteachtools")
```


# Template for Exam
Exams are created in a special Rmarkdown document using latex-features to create a title page.

```{r, eval=FALSE}
usethis::use_rmarkdown_template(template_name = "Exam Questions Skeleton Document",
                                template_dir = 'cexamdown',
                                template_description = 'Exam Template Document for charlotte-ngs',
                                template_create_dir = TRUE)
```

Using the template works with

```{r, eval=FALSE}
rmarkdown::draft(file = "exam/asm_exam_sol", template = "cexamdown", package = "rteachtools")
```


# Automation Strategies
The above shown manual steps should be integrated into an automation strategy. A new RStudio project can be created using the script `qrspm`. Then a function within `rteachtools` can be called which then steps through all other steps. 

```bash
cd;qrspm create Data/Projects/Github/charlotte-ngs/lbgfs2023_gh-root/main/lbgfs2023
```

The further steps are the executed from the RStudio console

Step 1: Licence is added 

```{r}
usethis::use_cc0_license()
```

Step 2: Website Pages

```{r, eval=FALSE}
usethis::use_vignette(name = "course_notes", title = "Course Notes")
usethis::use_vignette(name = "course_exercises", title = "Exercises")
usethis::use_vignette(name = "course_solutions", title = "Solutions")
usethis::use_vignette(name = "course_additional_material", title = "Additional Material")
```

Step 3: Initial Commit

```{r}
gert::git_add(".")
gert::git_commit("First commit of initial material")
```

Step 4: Install Package

```{r}
devtools::document();devtools::install()
```


Step 5: Adapt pkg yaml

```{r}
usethis::use_pkgdown()
# then manually adapt to version of previous year
```


Step 6: Build Site

Test build with 

```{r}
pkgdown::build_site()
```


Step 7: Github Repository

* go to `github.com` 
* login as `charlotte-ngs`
* create new repository `lbgfs2023`
* run the commands to add remote repository and to push to the remote repo

```bash
git remote add origin https://github.com/charlotte-ngs/lbgfs2023.git
git branch -M main
git push -u origin main
```

We are going to use the following command which activates github-pages with an automatic build after pushing to the remote repository. The required configuration is added in subdirectory `.github`.

```{r}
usethis::use_pkgdown_github_pages()
```


## Course Notes
Using the available templates for course notes, we get

```{r}
rmarkdown::draft("cn", template = "cnotesdown", package = "rteachtools", edit = FALSE)
```

The place holders have to be replaced. This works with the function `whisker::whisker.render()`. This is implemented in the function `create_cnotes()`. 

The empty bibliography file has to be deleted from the templates. This file is created when first building the course notes.







